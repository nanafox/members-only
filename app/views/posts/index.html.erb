<% content_for :title, "Posts" %>

<h1>Posts</h1>

<% if user_signed_in? %>
  <div>
    <%= link_to "New post", new_post_path, class: "btn btn-primary mb-3" %>
  </div>
<% end %>

<% if Post.count.zero? %>
  <h2>No Posts found at the moment</h2>
  <% unless user_signed_in? %>
    <%= button_to "Create one today!",
    new_post_path,
    class: "btn btn-dark",
    method: :get %>
  <% end %>
<% else %>
  <div id="posts">
    <% @posts.each do |post| %>
      <article id="<%= dom_id(post) %>" class="card p-3">
        <h2 class="card-title">
          <%= link_to post.title, post_path(post), class: "link-opacity-75-hover" %>
        </h2>
        <% if user_signed_in? %>
          <p>Posted by:
            <%= "#{post.user.first_name} #{post.user.last_name}" %>
          </p>
        <% end %>
        <p class="card-text">
          <%= truncate(post.content.to_plain_text, length: 100) %>
        </p>
      </article>
    <% end %>
  </div>
<% end %>
